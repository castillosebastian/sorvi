<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{sorvi Markdown Vignette made with knitr}

Joissakin esimerkeissa tarvittavat riippuvuudet 
	<a href="http://trac.osgeo.org/gdal/wiki/DownloadSource">GDAL</a>, 
	<a href="http://freeglut.sourceforge.net/">freeglut</a>, 
	<a href="http://xmlsoft.org/downloads.html">XML</a>, 
	<a href="http://trac.osgeo.org/geos">GEOS</a> ja 
	<a href="http://trac.osgeo.org/proj">PROJ.4</a>. 

-->

Finnish open government data toolkit for R
===========

sorvi provides miscellaneous tools for Finnish open government data to
complement other [rOpenGov](http://ropengov.github.io/projects)
packages with a more specific scope. We also maintain a [todo
list](todo-datasets) of further data sources to be added; your
[contributions are
welcome](http://louhos.github.com/contact.html). For further
information, see the [home page](http://louhos.github.com/sorvi).


## Installation

We assume you have installed [R](http://www.r-project.org/). If you
use [RStudio](http://www.rstudio.com/ide/download/desktop), change the
default encoding to UTF-8. Linux users should also install
[CURL](http://curl.haxx.se/download.html).

Install the stable release version in R:

```{r install, eval=FALSE}
install.packages("sorvi")
```

Test the installation by loading the library:

```{r test, eval=FALSE}
library(sorvi)
```

We also recommend setting the UTF-8 encoding:

```{r locale, eval=FALSE}
Sys.setlocale(locale="UTF-8") 
```

Brief examples of the package tools are provided below. Further
examples are available in [Louhos-blog](http://louhos.wordpress.com)
and in our [Rmarkdown blog](http://louhos.github.io/archive.html).


### Personal identification number (HETU)

Extract information from a Finnish personal identification number:

```{r hetu, message=FALSE}
library(sorvi)
hetu("111111-111C")
```

Validate Finnish personal identification number:

```{r hetu2, fig.message=FALSE}
valid_hetu("010101-0101") # TRUE/FALSE
```

### Postal codes

Get Finnish postal codes vs. municipalities table from Wikipedia

```{r postalcodes, message=FALSE, eval=TRUE}
postal.code.table <- get_postal_code_info() 
head(postal.code.table)
```

### IP Location

Get geographic coordinates for a given IP-address from
[datasciencetoolkit](http://www.datasciencetoolkit.org//ip2coordinates/):

```{r iplocation, message=FALSE}
ip_location("137.224.252.10")
```


### Municipality information

Finnish municipality information is available through Population
Registry (Vaestorekisterikeskus), Statistics Finland (Tilastokeskus)
and Land Survey Finland (Maanmittauslaitos). The row names for each
data set are harmonized and can be used to match data sets from
different sources, as different data sets may carry slightly different
versions of certain municipality names. Examples for each case:

Finnish municipality information from Land Survey Finland ([Maanmittauslaitos, MML](http://www.maanmittauslaitos.fi/aineistot-palvelut/latauspalvelut/avoimien-aineistojen-tiedostopalvelu)). 

```{r municipalityMML, message=FALSE, warning=FALSE, eval=TRUE}
municipality.info.mml <- get_municipality_info_mml()
municipality.info.mml[1:2,]
```

Get information of Finnish provinces from Statistics Finland ([Tilastokeskus](http://pxweb2.stat.fi/Database/Kuntien%20perustiedot/Kuntien%20perustiedot/Kuntaportaali.px))

```{r municipalityStatFi, message=FALSE, warning=FALSE, eval=TRUE}
municipality.info.statfi <- get_municipality_info_statfi()
municipality.info.statfi[1:2,]
```

List the province for each municipality in Finland:
```{r province2, message=FALSE, warning=FALSE, eval=TRUE}

# Specific municipalities
m2p <- find_province(c("Helsinki", "Tampere", "Turku")) 
head(m2p)

# All municipalities
m2p <- find_province(municipality.info.statfi$Kunta) 

# Speeding up with predefined municipality info table:
m2p <- find_province(c("Helsinki", "Tampere", "Turku"), municipality.info.mml)
head(m2p)
```

Convert municipality codes and names:
```{r province3, message=FALSE, eval=TRUE}
municipality_ids <- convert_municipality_codes()
head(municipality_ids)
```

Translate municipality names Finnish/English:

```{r translate, message=FALSE}
translations <- load_sorvi_data("translations")
head(translations)
```

### Retrieve population register data

Municipality-level population information from [Vaestorekisterikeskus](http://vrk.fi/default.aspx?docid=5127&site=3&id=0):

```{r popreg, message=FALSE}
df <- get_population_register()
head(df)
```

### Province information

Get information of Finnish provinces from Wikipedia:

```{r municipality, message=FALSE}
tab <- get_province_info_wikipedia()
head(tab)
```


### Visualization routines

Line fit with confidence smoothers:

```{r regressionline, message=FALSE, eval=TRUE}
library(sorvi)
library(plyr)
library(RColorBrewer)
library(reshape)
library(ggplot2)
data(iris)
p <- regression_plot(Sepal.Length ~ Sepal.Width, iris) 
print(p)
```


## Licensing and Citations

This work can be freely used, modified and distributed under the 
[Two-clause BSD license](http://en.wikipedia.org/wiki/BSD\_licenses).

Kindly cite the work, if appropriate, as 'Leo Lahti, Juuso Parkkinen,
Joona Lehtomaki et al. (2014). sorvi - R tools for Finnish open
government data. URL: http://louhos.github.com/sorvi'. A full list of
authors and contributors and contact information is
[here](http://louhos.github.com/contact).

## Session info

This vignette was created with

```{r sessioninfo, message=FALSE, warning=FALSE}
sessionInfo()
```




